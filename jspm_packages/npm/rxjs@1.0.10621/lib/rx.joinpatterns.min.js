/*
 Copyright (c) Microsoft Corporation.  All rights reserved.
 This code is licensed by Microsoft Corporation under the terms
 of the MICROSOFT REACTIVE EXTENSIONS FOR JAVASCRIPT AND .NET LIBRARIES License.
 See http://go.microsoft.com/fwlink/?LinkID=220762.
*/
module.exports=function(t,e){var r;r=t.Rx;var n,i,s,o,u,h,c=Array.prototype.slice,a=Object.prototype.hasOwnProperty,f=function(t,e){function r(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.base=e.prototype,t},l=r.Observable,p=l.prototype,v=l.createWithDisposable,y=l.throwException,d=r.Observer.create,b=r.Internals.List,g=r.SingleAssignmentDisposable,k=r.CompositeDisposable,m=r.Internals.AbstractObserver,C=function(t,e){return t===e};s=[1,3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143,4194301,8388593,16777213,33554393,67108859,134217689,268435399,536870909,1073741789,2147483647],i=function(t){var e,r;if(0&t)return 2===t;for(e=Math.sqrt(t),r=3;e>=r;){if(0===t%r)return!1;r+=2}return!0},n=function(t){var e,r;for(e=0;e<s.length;++e)if(r=s[e],r>=t)return r;for(e=1|t;e<s[s.length-1];){if(i(e))return e;e+=2}return t},o=0,u=function(t){var r;if(t===e)throw"no such key";return t.getHashCode!==e?t.getHashCode():(r=17*o++,t.getHashCode=function(){return r},r)},h=function(){return{key:null,value:null,next:0,hashCode:0}};var E,x=function(){function t(t,e){this._initialize(t),this.comparer=e||C,this.size=this.freeCount=0,this.freeList=-1}return t.prototype._initialize=function(t){var e,t=n(t);for(this.buckets=Array(t),this.entries=Array(t),e=0;t>e;e++)this.buckets[e]=-1,this.entries[e]=h();this.freeList=-1},t.prototype.count=function(){return this.size},t.prototype.add=function(t,e){return this._insert(t,e,!0)},t.prototype._insert=function(t,r,n){var i,s,o;for(this.buckets===e&&this._initialize(0),o=2147483647&u(t),i=o%this.buckets.length,s=this.buckets[i];s>=0;s=this.entries[s].next)if(this.entries[s].hashCode===o&&this.comparer(this.entries[s].key,t)){if(n)throw"duplicate key";return void(this.entries[s].value=r)}0<this.freeCount?(n=this.freeList,this.freeList=this.entries[n].next,--this.freeCount):(this.size===this.entries.length&&(this._resize(),i=o%this.buckets.length),n=this.size,++this.size),this.entries[n].hashCode=o,this.entries[n].next=this.buckets[i],this.entries[n].key=t,this.entries[n].value=r,this.buckets[i]=n},t.prototype._resize=function(){var t,e,r,i,s;for(s=n(2*this.size),r=Array(s),t=0;t<r.length;++t)r[t]=-1;for(i=Array(s),t=0;t<this.size;++t)i[t]=this.entries[t];for(t=this.size;s>t;++t)i[t]=h();for(t=0;t<this.size;++t)e=i[t].hashCode%s,i[t].next=r[e],r[e]=t;this.buckets=r,this.entries=i},t.prototype.remove=function(t){var r,n,i,s;if(this.buckets!==e)for(s=2147483647&u(t),r=s%this.buckets.length,n=-1,i=this.buckets[r];i>=0;i=this.entries[i].next){if(this.entries[i].hashCode===s&&this.comparer(this.entries[i].key,t))return 0>n?this.buckets[r]=this.entries[i].next:this.entries[n].next=this.entries[i].next,this.entries[i].hashCode=-1,this.entries[i].next=this.freeList,this.entries[i].key=null,this.entries[i].value=null,this.freeList=i,++this.freeCount,!0;n=i}return!1},t.prototype.clear=function(){var t;if(!(0>=this.size)){for(t=0;t<this.buckets.length;++t)this.buckets[t]=-1;for(t=0;t<this.size;++t)this.entries[t]=h();this.freeList=-1,this.size=0}},t.prototype._findEntry=function(t){var r,n;if(this.buckets!==e)for(n=2147483647&u(t),r=this.buckets[n%this.buckets.length];r>=0;r=this.entries[r].next)if(this.entries[r].hashCode===n&&this.comparer(this.entries[r].key,t))return r;return-1},t.prototype.count=function(){return this.size-this.freeCount},t.prototype.tryGetEntry=function(t){return t=this._findEntry(t),t>=0?{key:this.entries[t].key,value:this.entries[t].value}:e},t.prototype.getValues=function(){var t,r=0,n=[];if(this.entries!==e)for(t=0;t<this.size;t++)0<=this.entries[t].hashCode&&(n[r++]=this.entries[t].value);return n},t.prototype.get=function(t){if(t=this._findEntry(t),t>=0)return this.entries[t].value;throw Error("no such key")},t.prototype.set=function(t,e){this._insert(t,e,!1)},t.prototype.containskey=function(t){return 0<=this._findEntry(t)},t}(),w=function(){function t(t){this.patterns=t}return t.prototype.and=function(e){var r,n,i=this.patterns;for(n=[],r=0;r<i.length;r++)n.push(i[r]);return n.push(e),new t(n)},t.prototype.then=function(t){return new z(this,t)},t}(),z=function(){function t(t,e){this.expression=t,this.selector=e}return t.prototype.activate=function(t,e,r){var n,i,s,o;for(o=this,s=[],i=0;i<this.expression.patterns.length;i++)s.push(A(t,this.expression.patterns[i],function(t){e.onError(t)}));for(n=new E(s,function(){var t;try{t=o.selector.apply(o,arguments)}catch(r){return void e.onError(r)}e.onNext(t)},function(){var t;for(t=0;t<s.length;t++)s[t].removeActivePlan(n);r(n)}),i=0;i<s.length;i++)s[i].addActivePlan(n);return n},t}(),A=function(t,r,n){var i;return i=t.tryGetEntry(r),i===e?(n=new _(r,n),t.add(r,n),n):i.value};E=function(){function t(t,e,r){for(this.joinObserverArray=t,this.onNext=e,this.onCompleted=r,this.joinObservers=new x,t=0;t<this.joinObserverArray.length;t++)e=this.joinObserverArray[t],this.joinObservers.add(e,e)}return t.prototype.dequeue=function(){var t,e;for(e=this.joinObservers.getValues(),t=0;t<e.length;t++)e[t].queue.shift()},t.prototype.match=function(){var t,e,r;for(t=!0,e=0;e<this.joinObserverArray.length;e++)if(0===this.joinObserverArray[e].queue.length){t=!1;break}if(t){for(t=[],r=!1,e=0;e<this.joinObserverArray.length;e++)t.push(this.joinObserverArray[e].queue[0]),"C"===this.joinObserverArray[e].queue[0].kind&&(r=!0);if(r)this.onCompleted();else{for(this.dequeue(),r=[],e=0;e<t.length;e++)r.push(t[e].value);this.onNext.apply(this,r)}}},t}();var _=function(){function t(t,e){this.source=t,this.onError=e,this.queue=[],this.activePlans=new b,this.subscription=new g,this.isDisposed=!1}return f(t,m),t.prototype.addActivePlan=function(t){this.activePlans.add(t)},t.prototype.subscribe=function(){this.subscription.disposable(this.source.materialize().subscribe(this))},t.prototype.next=function(t){var e;if(!this.isDisposed)if("E"===t.kind)this.onError(t.exception);else for(this.queue.push(t),t=this.activePlans.toArray(),e=0;e<t.length;e++)t[e].match()},t.prototype.error=function(){},t.prototype.completed=function(){},t.prototype.removeActivePlan=function(t){this.activePlans.remove(t),0===this.activePlans.count()&&this.dispose()},t.prototype.dispose=function(){t.base.dispose.call(this),this.isDisposed||(this.isDisposed=!0,this.subscription.dispose())},t}();p.and=function(t){return new w([this,t])},p.then=function(t){return new w([this]).then(t)},l.when=function(){var t=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:c.call(arguments);return v(function(e){var r,n,i,s,o,u=new b,h=new x;o=d(function(t){e.onNext(t)},function(t){for(var r=h.getValues(),n=0;n<r.length;n++)r[n].onError(t);e.onError(t)},function(){e.onCompleted()});try{for(n=0;n<t.length;n++)u.add(t[n].activate(h,o,function(t){u.remove(t),0===u.count()&&o.onCompleted()}))}catch(c){y(c).subscribe(e)}for(r=new k,s=h.getValues(),n=0;n<s.length;n++)i=s[n],i.subscribe(),r.add(i);return r})}};
//# sourceMappingURL=jspm_packages\npm\rxjs@1.0.10621/lib\rx.joinpatterns.min.js.map