/* DOM Level2 Events implemented as described here:
 *
 * http://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html
 *
 */
function getDocument(t){return t.nodeType==core.Node.DOCUMENT_NODE?t:t._ownerDocument}function mutationEventsEnabled(t){return t.nodeType!=core.Node.ATTRIBUTE_NODE&&getDocument(t).implementation.hasFeature("MutationEvents")}function dispatchAttrEvent(t){return function(e,n,r){var o=this._parentNode,i=e.apply(this,n);if(mutationEventsEnabled(o)){var a,u=o._ownerDocument,c=events.MutationEvent.prototype[t],s=i&&i.name||r.name,l=i&&i.value||null,f="ADDITION"==t?r.value:null;f&&f==l||(a=u.createEvent("MutationEvents"),a.initMutationEvent("DOMAttrModified",!0,!1,o,l,f,s,c),o.dispatchEvent(a))}return i}}var core=require("./core").dom.level2.core,utils=require("../utils");core=Object.create(core);var events={};events.EventException=function(){this._code=arguments.length>0?arguments[0]:0,this._message=arguments.length>1?arguments[1]:"Unspecified event type",Error.call(this,this._message),Error.captureStackTrace&&Error.captureStackTrace(this,events.EventException)},events.EventException.prototype={UNSPECIFIED_EVENT_TYPE_ERR:0,get code(){return this._code}},events.EventException.prototype.__proto__=Error.prototype,events.Event=function(t){this._eventType=t,this._type=null,this._bubbles=null,this._cancelable=null,this._target=null,this._currentTarget=null,this._eventPhase=null,this._timeStamp=null,this._preventDefault=!1,this._stopPropagation=!1},events.Event.prototype={initEvent:function(t,e,n){this._type=t,this._bubbles=e,this._cancelable=n},preventDefault:function(){this._cancelable&&(this._preventDefault=!0)},stopPropagation:function(){this._stopPropagation=!0},CAPTURING_PHASE:1,AT_TARGET:2,BUBBLING_PHASE:3,get eventType(){return this._eventType},get type(){return this._type},get bubbles(){return this._bubbles},get cancelable(){return this._cancelable},get target(){return this._target},get currentTarget(){return this._currentTarget},get eventPhase(){return this._eventPhase},get timeStamp(){return this._timeStamp}},events.UIEvent=function(t){events.Event.call(this,t),this.view=null,this.detail=null},events.UIEvent.prototype={initUIEvent:function(t,e,n,r,o){this.initEvent(t,e,n),this.view=r,this.detail=o}},events.UIEvent.prototype.__proto__=events.Event.prototype,events.MouseEvent=function(t){events.UIEvent.call(this,t),this.screenX=null,this.screenY=null,this.clientX=null,this.clientY=null,this.ctrlKey=null,this.shiftKey=null,this.altKey=null,this.metaKey=null,this.button=null,this.relatedTarget=null},events.MouseEvent.prototype={initMouseEvent:function(t,e,n,r,o,i,a,u,c,s,l,f,h,p,d){this.initUIEvent(t,e,n,r,o),this.screenX=i,this.screenY=a,this.clientX=u,this.clientY=c,this.ctrlKey=s,this.shiftKey=f,this.altKey=l,this.metaKey=h,this.button=p,this.relatedTarget=d}},events.MouseEvent.prototype.__proto__=events.UIEvent.prototype,events.MutationEvent=function(t){events.Event.call(this,t),this.relatedNode=null,this.prevValue=null,this.newValue=null,this.attrName=null,this.attrChange=null},events.MutationEvent.prototype={initMutationEvent:function(t,e,n,r,o,i,a,u){this.initEvent(t,e,n),this.relatedNode=r,this.prevValue=o,this.newValue=i,this.attrName=a,this.attrChange=u},MODIFICATION:1,ADDITION:2,REMOVAL:3},events.MutationEvent.prototype.__proto__=events.Event.prototype,events.EventTarget=function(){},events.EventTarget.getListeners=function(t,e,n){var r=t._listeners&&t._listeners[e]&&t._listeners[e][n]||[];if(!n){var o=t["on"+e];if(o){var i=t._ownerDocument?t._ownerDocument.implementation:t.document.implementation;i.hasFeature("ProcessExternalResources","script")&&r.push(o)}}return r},events.EventTarget.dispatch=function(t,e,n){for(var r,o,i=e();i&&!t._stopPropagation;){for(r=events.EventTarget.getListeners(i,t._type,n),o=r.length;o--;){t._currentTarget=i;try{r[o].call(i,t)}catch(a){i.raise("error","Dispatching event '"+t._type+"' failed",{error:a,event:t})}}i=e()}return!t._stopPropagation},events.EventTarget.forwardIterator=function(t){var e=0,n=t.length;return function(){return n>e?t[e++]:null}},events.EventTarget.backwardIterator=function(t){var e=t.length;return function(){return e>=0?t[--e]:null}},events.EventTarget.singleIterator=function(t){var e=1;return function(){return e--?t:null}},events.EventTarget.prototype={addEventListener:function(t,e,n){this._listeners=this._listeners||{};var r=this._listeners[t]||{};n=n===!0;for(var o=r[n]||[],i=0;i<o.length;i++)if(o[i]===e)return;o.push(e),r[n]=o,this._listeners[t]=r},removeEventListener:function(t,e,n){var r=this._listeners&&this._listeners[t];if(r){var o=r[n===!0];if(o)for(var i=0;i<o.length;i++)if(o[i]===e)return void o.splice(i,1)}},dispatchEvent:function(t){if(null==t)throw new events.EventException(0,"Null event");if(null==t._type||""==t._type)throw new events.EventException(0,"Uninitialized event");var e=[];t._target=this;for(var n=this,r=n._parentNode;r;)e.push(r),n=r,r=n._parentNode;r=n._parentWindow,r&&e.push(r);var o=events.EventTarget.backwardIterator(e);if(t._eventPhase=t.CAPTURING_PHASE,!events.EventTarget.dispatch(t,o,!0))return t._preventDefault;if(o=events.EventTarget.singleIterator(t._target),t._eventPhase=t.AT_TARGET,!events.EventTarget.dispatch(t,o,!1))return t._preventDefault;if(t._bubbles&&!t._stopPropagation){o=events.EventTarget.forwardIterator(e),t._eventPhase=t.BUBBLING_PHASE,events.EventTarget.dispatch(t,o,!1)}return t._preventDefault}},core.Node.prototype.__proto__=events.EventTarget.prototype,utils.intercept(core.Node,"insertBefore",function(t,e,n){var r=t.apply(this,e);if(mutationEventsEnabled(this)){var o=getDocument(this),i=o.createEvent("MutationEvents");i.initMutationEvent("DOMNodeInserted",!0,!1,this,null,null,null,null),n.dispatchEvent(i),(this.nodeType==core.Node.DOCUMENT_NODE||this._attachedToDocument)&&(i=o.createEvent("MutationEvents"),i.initMutationEvent("DOMNodeInsertedIntoDocument",!1,!1,null,null,null,null,null),core.visitTree(n,function(t){t.nodeType==core.Node.ELEMENT_NODE&&(t.dispatchEvent(i),t._attachedToDocument=!0)}))}return r}),utils.intercept(core.Node,"removeChild",function(t,e,n){if(mutationEventsEnabled(this)){var r=getDocument(this),o=r.createEvent("MutationEvents");o.initMutationEvent("DOMNodeRemoved",!0,!1,this,null,null,null,null),n.dispatchEvent(o),o=r.createEvent("MutationEvents"),o.initMutationEvent("DOMNodeRemovedFromDocument",!1,!1,null,null,null,null,null),core.visitTree(n,function(t){t.nodeType==core.Node.ELEMENT_NODE&&(t.dispatchEvent(o),t._attachedToDocument=!1)})}return t.apply(this,e)}),utils.intercept(core.AttrNodeMap,"removeNamedItem",dispatchAttrEvent("REMOVAL")),utils.intercept(core.AttrNodeMap,"setNamedItem",dispatchAttrEvent("ADDITION")),core.CharacterData.prototype.__defineGetter__("_nodeValue",function(){return this.__nodeValue}),core.CharacterData.prototype.__defineSetter__("_nodeValue",function(t){var e=this.__nodeValue;if(this.__nodeValue=t,this._ownerDocument&&this._parentNode&&mutationEventsEnabled(this)){var n=this._ownerDocument.createEvent("MutationEvents");n.initMutationEvent("DOMCharacterDataModified",!0,!1,this,e,t,null,null),this.dispatchEvent(n)}}),core.Document.prototype.createEvent=function(t){switch(t){case"MutationEvents":return new events.MutationEvent(t);case"UIEvents":return new events.UIEvent(t);case"MouseEvents":return new events.MouseEvent(t);case"HTMLEvents":return new events.Event(t)}return new events.Event(t)},exports.dom={level2:{core:core,events:events}};
//# sourceMappingURL=jspm_packages/npm/jsdom@0.5.7/level2/events.js.map