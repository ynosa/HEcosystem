function fetchStylesheet(t,e){html.resourceLoader.load(this,t,function(n){evaluateStylesheet.call(this,n,e,t)})}function evaluateStylesheet(t,e,n){var r=cssom.parse(t),o=r.cssRules;o.unshift(0,e.cssRules.length),Array.prototype.splice.apply(e.cssRules,o),scanForImportRules.call(this,e.cssRules,n),this.ownerDocument.styleSheets.push(e)}function scanForImportRules(t,e){if(t)for(var n=0;n<t.length;++n)t[n].cssRules?scanForImportRules.call(this,t[n].cssRules,e):t[n].href&&fetchStylesheet.call(this,t[n].href,this.sheet)}function evaluateStyleAttribute(){}function StyleAttr(t,e){this._node=t,core.Attr.call(this,t.ownerDocument,"style"),this._node._ignoreValueOfStyleAttr||(this.nodeValue=e)}var core=require("./core").dom.level2.core,html=require("./html").dom.level2.html,utils=require("../utils"),cssom=require("cssom"),cssstyle=require("cssstyle"),assert=require("github:jspm/nodelibs@0.0.2/assert");core.StyleSheet=cssom.StyleSheet,core.MediaList=cssom.MediaList,core.CSSStyleSheet=cssom.CSSStyleSheet,core.CSSRule=cssom.CSSRule,core.CSSStyleRule=cssom.CSSStyleRule,core.CSSMediaRule=cssom.CSSMediaRule,core.CSSImportRule=cssom.CSSImportRule,core.CSSStyleDeclaration=cssstyle.CSSStyleDeclaration,core.StyleSheetList=function(){this._length=0},core.StyleSheetList.prototype={item:function(t){return this[t]},push:function(t){this[this._length]=t,this._length++},get length(){return this._length}},core.Document.prototype.__defineGetter__("styleSheets",function(){return this._styleSheets||(this._styleSheets=new core.StyleSheetList),this._styleSheets}),StyleAttr.prototype={get nodeValue(){return"string"==typeof this._node._style?this._node._style:this._node.style.cssText},set nodeValue(t){this._node._style=t}},StyleAttr.prototype.__proto__=core.Attr.prototype,utils.intercept(core.AttrNodeMap,"setNamedItem",function(t,e,n){return"style"==n.name&&(n=new StyleAttr(this._parentNode,n.nodeValue)),t.call(this,n)}),html.HTMLElement.prototype.__defineGetter__("style",function(){if("string"==typeof this._style){var t=cssom.parse("dummy{"+this._style+"}");if(this._style=new cssstyle.CSSStyleDeclaration,t.cssRules.length>0&&t.cssRules[0].style)for(var e=t.cssRules[0].style,n=0;n<e.length;++n){var r=e[n];this._style.setProperty(r,e.getPropertyValue(r),e.getPropertyPriority(r))}}return this._style||(this._style=new cssstyle.CSSStyleDeclaration),this.getAttributeNode("style")||(this._ignoreValueOfStyleAttr=!0,this.setAttribute("style"),this._ignoreValueOfStyleAttr=!1),this._style}),assert.equal(void 0,html.HTMLLinkElement._init),html.HTMLLinkElement._init=function(){this.addEventListener("DOMNodeInsertedIntoDocument",function(){/(?:[ \t\n\r\f]|^)stylesheet(?:[ \t\n\r\f]|$)/i.test(this.rel)&&this.href&&fetchStylesheet.call(this,this.href,this.sheet)}),this.addEventListener("DOMNodeRemovedFromDocument",function(){})};var getOrCreateSheet=function(){return this._cssStyleSheet||(this._cssStyleSheet=new cssom.CSSStyleSheet),this._cssStyleSheet};html.HTMLLinkElement.prototype.__defineGetter__("sheet",getOrCreateSheet),assert.equal(void 0,html.HTMLStyleElement._init),html.HTMLStyleElement._init=function(){this.addEventListener("DOMNodeInsertedIntoDocument",function(){if(!this.type||"text/css"===this.type){var t="";Array.prototype.forEach.call(this.childNodes,function(e){e.nodeType===e.TEXT_NODE&&(t+=e.nodeValue)}),evaluateStylesheet.call(this,t,this.sheet,this._ownerDocument.URL)}})},html.HTMLStyleElement.prototype.__defineGetter__("sheet",getOrCreateSheet),exports.dom={level2:{html:html,core:core}};
//# sourceMappingURL=jspm_packages/npm/jsdom@0.5.7/level2/style.js.map