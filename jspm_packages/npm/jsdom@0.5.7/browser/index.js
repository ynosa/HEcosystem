function NOT_IMPLEMENTED(t){return function(){if(!jsdom.debugMode){var e=t?t.raise:this.raise;e.call(this,"error","NOT IMPLEMENTED")}}}function matchesDontThrow(t,e){try{return t.matchesSelector(e)}catch(n){return!1}}var http=require("github:jspm/nodelibs@0.0.2/http"),URL=require("github:jspm/nodelibs@0.0.2/url"),HtmlToDom=require("./htmltodom").HtmlToDom,domToHtml=require("./domtohtml").domToHtml,htmlencoding=require("./htmlencoding"),HTMLEncode=htmlencoding.HTMLEncode,HTMLDecode=htmlencoding.HTMLDecode,jsdom=require("../../jsdom"),CSSStyleDeclaration=require("cssstyle").CSSStyleDeclaration,Contextify=null;try{Contextify=require("contextify")}catch(e){Contextify=function(t){var e=require("github:jspm/nodelibs@0.0.2/vm"),n=e.createContext(t),r=null;return t.run=function(t,r){return e.runInContext(t,n,r)},t.getGlobal=function(){return r||(r=e.runInContext("this",n)),r},t.dispose=function(){r=null,t.run=function(){throw new Error("Called run() after dispose().")},t.getGlobal=function(){throw new Error("Called getGlobal() after dispose().")},t.dispose=function(){throw new Error("Called dispose() after dispose().")}},t}}exports.windowAugmentation=function(t,e){e=e||{};var n=exports.createWindow(t,e);if(!e.document){var r=browserAugmentation(t,e);e.document=r.HTMLDocument?new r.HTMLDocument(e):new r.Document(e),e.document.write("<html><head></head><body></body></html>")}var o=n.document=e.document;if(o.addEventListener)if("complete"==o.readyState){var i=o.createEvent("HTMLEvents");i.initEvent("load",!1,!1),process.nextTick(function(){n.dispatchEvent(i)})}else o.addEventListener("load",function(t){n.dispatchEvent(t)});return n},exports.createWindow=function(t,e){function n(t,e,n,r){var o=t(n,r);return a.push([o,e]),o}function r(t){if("undefined"!=typeof t)for(var e in a)if(a[e][0]===t){a[e][1].call(this,t),a.splice(e,1);break}}function o(){a.forEach(function(t){t[1].call(this,t[0])}),a=[]}function i(e){var i=(e||{}).url||"file://"+__filename;this.location=URL.parse(i),this.location.reload=NOT_IMPLEMENTED(this),this.location.replace=NOT_IMPLEMENTED(this),this.location.toString=function(){return i};var a=this.console._window=this;this.location.__defineGetter__("hash",function(){return a.location.href.split("#").length>1?"#"+a.location.href.split("#")[1]:""}),this.location.__defineSetter__("hash",function(t){a.location.href=a.location.href.split("#")[0]+t}),this.location.__defineGetter__("search",function(){return a.location.href.split("?").length>1?"?"+a.location.href.match(/\?([^#]+)/)[1]:""}),this.location.__defineSetter__("search",function(t){a.location.href=a.location.href.indexOf("?")>0?a.location.href.replace(/\?([^#]+)/,t):a.location.href.match(/^([^#?]+)/)[0]+t+a.location.hash}),e&&e.document&&(e.document.location=this.location),this.addEventListener=function(){t.Node.prototype.addEventListener.apply(a,arguments)},this.removeEventListener=function(){t.Node.prototype.removeEventListener.apply(a,arguments)},this.dispatchEvent=function(){t.Node.prototype.dispatchEvent.apply(a,arguments)},this.raise=function(){t.Node.prototype.raise.apply(a.document,arguments)},this.setTimeout=function(t,e){return n(setTimeout,clearTimeout,t,e)},this.setInterval=function(t,e){return n(setInterval,clearInterval,t,e)},this.clearInterval=r,this.clearTimeout=r,this.__stopAllTimers=o}var a=[];i.prototype={__proto__:t,_length:0,get length(){return this._length},close:function(){var t=this;!function e(n){var r;if(n.length>0)for(r=0;r<n.length;r++)e(n[r]);n!==t&&n.close()}(this),this.document&&(this.document.body&&(this.document.body.innerHTML=""),this.document.close&&(this.document._listeners=[],this.document.close()),delete this.document),o(),this.dispose()},getComputedStyle:function(t){function e(e){if(e.selectorText){var n=e.selectorText.split(/\s*,\s*/),i=!1;n.forEach(function(n){!i&&matchesDontThrow(t,n)&&(i=!0,o.call(e.style,function(t){r.setProperty(t,e.style.getPropertyValue(t),e.style.getPropertyPriority(t))}))})}}var n=t.style,r=new CSSStyleDeclaration,o=Array.prototype.forEach;return o.call(t.ownerDocument.styleSheets,function(t){o.call(t.cssRules,function(t){t.media?-1!==Array.prototype.indexOf.call(t.media,"screen")&&o.call(t.cssRules,e):e(t)})}),o.call(n,function(t){r.setProperty(t,n.getPropertyValue(t),n.getPropertyPriority(t))}),r},console:{log:function(t){this._window.raise("log",t)},info:function(t){this._window.raise("info",t)},warn:function(t){this._window.raise("warn",t)},error:function(t){this._window.raise("error",t)}},navigator:{userAgent:"Node.js ("+process.platform+"; U; rv:"+process.version+")",appName:"Node.js jsDom",platform:process.platform,appVersion:process.version},XMLHttpRequest:function(){},name:"nodejs",innerWidth:1024,innerHeight:768,outerWidth:1024,outerHeight:768,pageXOffset:0,pageYOffset:0,screenX:0,screenY:0,screenLeft:0,screenTop:0,scrollX:0,scrollY:0,scrollTop:0,scrollLeft:0,alert:NOT_IMPLEMENTED(),blur:NOT_IMPLEMENTED(),confirm:NOT_IMPLEMENTED(),createPopup:NOT_IMPLEMENTED(),focus:NOT_IMPLEMENTED(),moveBy:NOT_IMPLEMENTED(),moveTo:NOT_IMPLEMENTED(),open:NOT_IMPLEMENTED(),print:NOT_IMPLEMENTED(),prompt:NOT_IMPLEMENTED(),resizeBy:NOT_IMPLEMENTED(),resizeTo:NOT_IMPLEMENTED(),scroll:NOT_IMPLEMENTED(),scrollBy:NOT_IMPLEMENTED(),scrollTo:NOT_IMPLEMENTED(),screen:{width:0,height:0},Image:NOT_IMPLEMENTED()};var u=new i(e);Contextify(u);var s=u.getGlobal();return u.window=u.frames=u.self=u.parent=u.top=s,u};var defaultParser=null,getDefaultParser=exports.getDefaultParser=function(){if(null===defaultParser)try{defaultParser=require("htmlparser")}catch(t){try{defaultParser=require("node-htmlparser/lib/node-htmlparser")}catch(e){defaultParser=void 0}}return defaultParser};exports.setDefaultParser=function(t){"object"==typeof t?defaultParser=t:"string"==typeof t&&(defaultParser=require(t))};var browserAugmentation=exports.browserAugmentation=function(t,e){function n(e,n){var r="",o="",c="",l="HTML",h=n.match(i);if(e._doctype=null,h&&h[0])c=h[0];else{var f,p=n.indexOf(u),d=n.indexOf(s);if(0>p||0>d)return;if(f=n.substr(p,d-p+s.length),h=f.replace(/[\n\r]/g,"").match(a),!h)return;c=h[0],h=h[1].split(' "');var g=h.length?h.pop().replace(/"/g,""):"",m=h.length?h.pop().replace(/"/g,""):"";-1!==g.indexOf("-//")&&(r=g),-1!==m.indexOf("-//")&&(r=m),-1!==g.indexOf("://")&&(o=g),-1!==m.indexOf("://")&&(o=m),h.length&&(h=h[0].split(" "),l=h[0].toUpperCase())}e._doctype=(new t.DOMImplementation).createDocumentType(l,r,o),e._doctype._ownerDocument=e,e._doctype._fullDT=c,e._doctype.toString=function(){return this._fullDT}}e||(e={});var r=e.parser||getDefaultParser();if(t._augmented&&t._parser===r)return t;t._parser=r;var o=new HtmlToDom(r);t.HTMLDocument||(t.HTMLDocument=t.Document),t.HTMLDocument.prototype.write||(t.HTMLDocument.prototype.write=function(t){this.innerHTML=t}),t.Element.prototype.getElementsByClassName=function(e){function n(n){if(!n)return!1;n.nodeType&&n.nodeType===t.Node.ENTITY_REFERENCE_NODE&&(n=n._entity);var r=n.className;if(r)for(var o=r.split(" "),i=0;i<o.length;i++)if(o[i]===e)return!0;return!1}return new t.NodeList(this.ownerDocument||this,t.mapper(this,n))},t.Element.prototype.__defineGetter__("sourceIndex",function(){for(var t=this.ownerDocument.getElementsByTagName("*"),e=t.length,n=0;e>n;n++)if(t[n]===this)return n}),t.Document.prototype.__defineGetter__("outerHTML",function(){return domToHtml(this,!0)}),t.Element.prototype.__defineGetter__("outerHTML",function(){return domToHtml(this,!0)}),t.Element.prototype.__defineGetter__("innerHTML",function(){if(/^(?:script|style)$/.test(this._tagName)){var t=this.getAttribute("type");if(!t||/^text\//i.test(t)||/\/javascript$/i.test(t))return domToHtml(this._childNodes,!0,!0)}return domToHtml(this._childNodes,!0)}),t.Element.prototype.__defineSetter__("doctype",function(){throw new t.DOMException(t.NO_MODIFICATION_ALLOWED_ERR)}),t.Element.prototype.__defineGetter__("doctype",function(){var t=null;return"#document"==this.nodeName&&this._doctype&&(t=this._doctype),t}),t.Element.prototype.__defineSetter__("innerHTML",function(t){for(var e;e=this._childNodes[0];)this.removeChild(e);return"#document"===this.nodeName&&n(this,t),""!==t&&null!=t&&o.appendHtmlToElement(t,this),t}),t.Document.prototype.__defineGetter__("innerHTML",function(){return domToHtml(this._childNodes,!0)}),t.Document.prototype.__defineSetter__("innerHTML",function(t){for(var e;e=this._childNodes[0];)this.removeChild(e);return"#document"===this.nodeName&&n(this,t),""!==t&&null!=t&&o.appendHtmlToElement(t,this),t});var i=/<!doctype html>/i,a=/<!DOCTYPE (\w(.|\n)*)">/i,u="<!DOCTYPE ",s='">';return t.Document.prototype.getElementsByClassName=function(e){function n(n){if(!n)return!1;n.nodeType&&n.nodeType===t.Node.ENTITY_REFERENCE_NODE&&(n=n._entity);var r=n.className;if(r)for(var o=r.split(" "),i=0;i<o.length;i++)if(o[i]===e)return!0;return!1}return new t.NodeList(this.ownerDocument||this,t.mapper(this,n))},t.Element.prototype.__defineGetter__("nodeName",function(){return this._nodeName.toUpperCase()}),t.Element.prototype.__defineGetter__("tagName",function(){var t=this._tagName.toUpperCase();return"#document"===this.nodeName&&(t=null),t}),t.Element.prototype.scrollTop=0,t.Element.prototype.scrollLeft=0,t.Document.prototype.__defineGetter__("parentWindow",function(){if(!this._parentWindow){var e=exports.windowAugmentation(t,{document:this,url:this.URL});this._parentWindow=e.getGlobal()}return this._parentWindow}),t.Document.prototype.__defineSetter__("parentWindow",function(t){this._parentWindow=t.getGlobal()}),t.Document.prototype.__defineGetter__("defaultView",function(){return this.parentWindow}),t._augmented=!0,t};
//# sourceMappingURL=jspm_packages/npm/jsdom@0.5.7/browser/index.js.map